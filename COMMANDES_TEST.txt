================================================================================
          GUIDE RAPIDE - COMMANDES DE TEST ET D'UTILISATION
================================================================================

Ce fichier contient toutes les commandes n√©cessaires pour tester rapidement
votre blockchain. Copiez-collez ces commandes dans votre terminal.

================================================================================
1. INSTALLATION
================================================================================

# Installer les d√©pendances
pip install Flask requests

# Ou via requirements.txt
pip install -r requirements.txt

================================================================================
2. TESTS DE BASE (Sans API)
================================================================================

# Test 1: Ex√©cuter blockchain.py directement
python blockchain.py

# Ce qui va se passer:
# - Cr√©ation d'une blockchain
# - Ajout de transactions
# - Minage de 2 blocs
# - Affichage de la cha√Æne compl√®te
# - Validation de l'int√©grit√©
# - Affichage des soldes

# Test 2: D√©mo interactive
python test_demo.py

# Menu interactif avec plusieurs d√©mos:
# 1. D√©mo compl√®te
# 2. D√©mo s√©curit√©
# 3. D√©mo difficult√©
# 4. D√©mo soldes
# 5. Toutes les d√©mos

================================================================================
3. D√âMARRAGE DE L'API REST
================================================================================

# Option 1: Port par d√©faut (5000)
python app.py

# Option 2: Port personnalis√©
python app.py --port 5001

# Le serveur sera accessible sur: http://127.0.0.1:5000

================================================================================
4. TESTS DE L'API AVEC CURL
================================================================================

# 4.1. Consulter la documentation
curl http://127.0.0.1:5000/

# 4.2. Voir la blockchain compl√®te
curl http://127.0.0.1:5000/chain

# 4.3. Ajouter une transaction
curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Alice","recipient":"Bob","amount":50}'

# 4.4. Ajouter plusieurs transactions
curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Bob","recipient":"Charlie","amount":25}'

curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Charlie","recipient":"David","amount":10}'

# 4.5. Miner un bloc
curl -X POST http://127.0.0.1:5000/mine \
  -H "Content-Type: application/json" \
  -d '{"miner":"Miner1"}'

# Attendez que le minage se termine (environ 10-15 secondes)

# 4.6. Voir la blockchain mise √† jour
curl http://127.0.0.1:5000/chain

# 4.7. V√©rifier la validit√©
curl http://127.0.0.1:5000/validate

# 4.8. Obtenir le solde d'Alice
curl http://127.0.0.1:5000/balance/Alice

# 4.9. Obtenir le solde du mineur
curl http://127.0.0.1:5000/balance/Miner1

================================================================================
5. TESTS R√âSEAU MULTI-N≈íUDS (PARTIE II)
================================================================================

# 5.1. D√©marrer 3 n≈ìuds dans 3 terminaux diff√©rents

# TERMINAL 1 - N≈ìud 1 (Port 5000)
python app.py --port 5000

# TERMINAL 2 - N≈ìud 2 (Port 5001)
python app.py --port 5001

# TERMINAL 3 - N≈ìud 3 (Port 5002)
python app.py --port 5002

# 5.2. Dans un 4√®me terminal, enregistrer les n≈ìuds

# Enregistrer le n≈ìud 2 et 3 sur le n≈ìud 1
curl -X POST http://127.0.0.1:5000/nodes/register \
  -H "Content-Type: application/json" \
  -d '{"nodes":["http://127.0.0.1:5001","http://127.0.0.1:5002"]}'

# Enregistrer le n≈ìud 1 et 3 sur le n≈ìud 2
curl -X POST http://127.0.0.1:5001/nodes/register \
  -H "Content-Type: application/json" \
  -d '{"nodes":["http://127.0.0.1:5000","http://127.0.0.1:5002"]}'

# Enregistrer le n≈ìud 1 et 2 sur le n≈ìud 3
curl -X POST http://127.0.0.1:5002/nodes/register \
  -H "Content-Type: application/json" \
  -d '{"nodes":["http://127.0.0.1:5000","http://127.0.0.1:5001"]}'

# 5.3. V√©rifier les n≈ìuds enregistr√©s
curl http://127.0.0.1:5000/nodes/list
curl http://127.0.0.1:5001/nodes/list
curl http://127.0.0.1:5002/nodes/list

# 5.4. Miner des blocs sur le n≈ìud 1 uniquement
curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Alice","recipient":"Bob","amount":100}'

curl -X POST http://127.0.0.1:5000/mine \
  -H "Content-Type: application/json" \
  -d '{"miner":"Miner1"}'

# Attendre que le minage se termine

# 5.5. V√©rifier les longueurs de cha√Æne
curl http://127.0.0.1:5000/chain/length
curl http://127.0.0.1:5001/chain/length
curl http://127.0.0.1:5002/chain/length

# N≈ìud 1 devrait avoir 2 blocs (genesis + 1)
# N≈ìuds 2 et 3 devraient avoir 1 bloc (genesis uniquement)

# 5.6. Synchroniser le n≈ìud 2
curl http://127.0.0.1:5001/nodes/resolve

# V√©rifier que le n≈ìud 2 a maintenant 2 blocs
curl http://127.0.0.1:5001/chain/length

# 5.7. Synchroniser le n≈ìud 3
curl http://127.0.0.1:5002/nodes/resolve

# V√©rifier que le n≈ìud 3 a maintenant 2 blocs
curl http://127.0.0.1:5002/chain/length

# 5.8. Tous les n≈ìuds devraient maintenant avoir la m√™me cha√Æne!

================================================================================
6. SC√âNARIO COMPLET DE D√âMONSTRATION
================================================================================

# 6.1. D√©marrer le serveur
python app.py

# 6.2. Cr√©er plusieurs transactions
curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Alice","recipient":"Bob","amount":50}'

curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Bob","recipient":"Charlie","amount":25}'

curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Charlie","recipient":"David","amount":10}'

# 6.3. Miner le premier bloc
curl -X POST http://127.0.0.1:5000/mine \
  -H "Content-Type: application/json" \
  -d '{"miner":"Miner1"}'

# 6.4. Ajouter d'autres transactions
curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"David","recipient":"Alice","amount":5}'

curl -X POST http://127.0.0.1:5000/transactions/new \
  -H "Content-Type: application/json" \
  -d '{"sender":"Bob","recipient":"Alice","amount":20}'

# 6.5. Miner le deuxi√®me bloc
curl -X POST http://127.0.0.1:5000/mine \
  -H "Content-Type: application/json" \
  -d '{"miner":"Miner2"}'

# 6.6. Afficher la blockchain compl√®te
curl http://127.0.0.1:5000/chain

# 6.7. Valider l'int√©grit√©
curl http://127.0.0.1:5000/validate

# 6.8. V√©rifier les soldes
curl http://127.0.0.1:5000/balance/Alice
curl http://127.0.0.1:5000/balance/Bob
curl http://127.0.0.1:5000/balance/Charlie
curl http://127.0.0.1:5000/balance/David
curl http://127.0.0.1:5000/balance/Miner1
curl http://127.0.0.1:5000/balance/Miner2

================================================================================
7. TESTS AVEC PYTHON (SCRIPT)
================================================================================

# Cr√©er un fichier test_api.py avec ce contenu:

import requests
import time

BASE_URL = "http://127.0.0.1:5000"

print("üöÄ Test de l'API Blockchain")
print("="*80)

# 1. Ajouter des transactions
print("\n1. Ajout de transactions...")
transactions = [
    ("Alice", "Bob", 50),
    ("Bob", "Charlie", 25),
    ("Charlie", "David", 10)
]

for sender, recipient, amount in transactions:
    response = requests.post(f"{BASE_URL}/transactions/new", json={
        "sender": sender,
        "recipient": recipient,
        "amount": amount
    })
    if response.status_code == 201:
        print(f"   ‚úÖ {sender} ‚Üí {recipient}: {amount} unit√©s")

# 2. Miner
print("\n2. Minage du bloc...")
response = requests.post(f"{BASE_URL}/mine", json={"miner": "TestMiner"})
if response.status_code == 200:
    data = response.json()
    print(f"   ‚úÖ Bloc min√©!")
    print(f"   Hash: {data['block']['hash']}")
    print(f"   Nonce: {data['block']['nonce']}")

# 3. Obtenir la cha√Æne
print("\n3. R√©cup√©ration de la blockchain...")
response = requests.get(f"{BASE_URL}/chain")
if response.status_code == 200:
    data = response.json()
    print(f"   ‚úÖ Longueur: {data['length']} blocs")

# 4. Validation
print("\n4. Validation de la cha√Æne...")
response = requests.get(f"{BASE_URL}/validate")
if response.status_code == 200:
    data = response.json()
    print(f"   ‚úÖ Valide: {data['valid']}")

# 5. Soldes
print("\n5. Soldes finaux:")
for person in ["Alice", "Bob", "Charlie", "David", "TestMiner"]:
    response = requests.get(f"{BASE_URL}/balance/{person}")
    if response.status_code == 200:
        balance = response.json()['balance']
        print(f"   üí∞ {person:<15}: {balance:>8.2f} unit√©s")

print("\n" + "="*80)
print("‚úÖ Test termin√©!")

# Puis ex√©cuter:
# python test_api.py

================================================================================
8. CAPTURE DES R√âSULTATS
================================================================================

# Pour capturer les r√©sultats dans un fichier:

# Cha√Æne compl√®te
curl http://127.0.0.1:5000/chain > blockchain_result.json

# Validation
curl http://127.0.0.1:5000/validate > validation_result.json

# Soldes
curl http://127.0.0.1:5000/balance/Alice > balance_alice.json

# Pour un affichage format√© (avec jq si install√©):
curl http://127.0.0.1:5000/chain | jq '.'

================================================================================
9. D√âPANNAGE
================================================================================

# Probl√®me 1: Port d√©j√† utilis√©
# Solution: Changer le port
python app.py --port 5555

# Probl√®me 2: Module Flask non trouv√©
# Solution: R√©installer Flask
pip install --upgrade Flask

# Probl√®me 3: Connexion refus√©e entre n≈ìuds
# Solution: V√©rifier que tous les n≈ìuds sont d√©marr√©s
# et utiliser 127.0.0.1 au lieu de localhost

# Probl√®me 4: Minage trop long
# Solution: R√©duire la difficult√© dans blockchain.py
# Changer: blockchain = Blockchain(difficulty=3)  # Au lieu de 4

# Probl√®me 5: Erreur JSON dans curl
# Solution: V√©rifier les guillemets et √©chapper si n√©cessaire
# Sur Windows: utiliser des guillemets doubles et √©chapper les guillemets internes

================================================================================
10. COMMANDES UTILES
================================================================================

# Tuer un processus sur un port sp√©cifique (si bloqu√©)
# Linux/Mac:
lsof -i :5000
kill -9 [PID]

# Windows:
netstat -ano | findstr :5000
taskkill /PID [PID] /F

# V√©rifier que le serveur r√©pond
curl -I http://127.0.0.1:5000/

# Afficher les logs en temps r√©el
# (Les logs s'affichent automatiquement dans le terminal du serveur)

================================================================================
FIN DU GUIDE
================================================================================

Bon courage pour les tests! üöÄ

Pour toute question, n'h√©sitez pas √† consulter le README.md ou le rapport complet.
